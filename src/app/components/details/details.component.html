<div class="container details">
    <div class="row">

        <div class="col-md-2">
            <app-categories></app-categories>
        </div>

        <div class="col-md-7">
            <div id="content">
                <div id="test" style="display: inline;">
                    <a *ngIf="!(memeDetails?.userName == 'admin')" id="ref" href="profile/{{memeDetails?.userName}}">{{memeDetails?.userName}}</a>
                    <p *ngIf="memeDetails?.userName == 'admin'" style="display: inline;">{{memeDetails.userName}}</p>
                    <p style="display: inline; padding-left: 5px;"> - {{memeDetails?.creationDate}}</p>
                    <div *ngIf="userService.IsLoggedIn()" style="float: right;">
                        <img type="submit" src="assets/icons/f02.png" (click)="addFavourite(memeDetails.memeId)">
                    </div>
                </div>
                    <h2 style="color: black;" >{{memeDetails?.title}}</h2>
                    <div>
                        <img class="responsive" *ngIf="memeDetails?.byteHead != null" src="{{memeDetails.byteHead}},{{memeDetails.byteImg}}">
                    </div>
                
                <div>
                    <p>Rate: {{memeDetails?.rate}} - Comments: {{memeDetails?.commentCount}} - Category: 
                        <a id="ref" href="category/{{memeDetails?.category.categoryName}}/1">{{memeDetails?.category.categoryName}}</a> </p>
                </div>

                <app-vote [memeDetails]="memeDetails"></app-vote>

            </div>

            <div class="comments">
                <div *ngIf="!userService.IsLoggedIn()">
                    <a href="user/login">Sign in to see comments</a>
                </div>
                <div *ngIf="userService.IsLoggedIn()">
                    <form id="addcomment" class="container" [formGroup]="commentService.addComment" autocomplete="off" (submit)="OnSubmit()">
                        <div class="row" >
                            <div class="form-group required col-md-12">
                                <label>Add Comment</label>
                                <textarea id="addcommenttxt" class="form-control" formControlName="txt"></textarea>
                                <label class="text-danger" *ngIf="commentService.addComment.get('txt').touched && commentService.addComment.get('txt').errors?.required">txt required</label>
                            </div>
                        </div> 
                        <button id="addbutton" type="submit" class="btn btn-lg" [disabled]="!commentService.addComment.valid">Add</button>  
                    </form>

                    <div>
                        <label class="commentList">COMMENTS:</label>
                        <div *ngFor="let item of comments; let i = index">
                            <div class="perComment">
                                <div class="comment-header">
                                    <a style="display: inline;" *ngIf="item.userName != 'admin'" id="ref" href="profile/{{item.userName}}">{{item.userName}}</a>
                                    <p style="display: inline;" *ngIf="item.userName == 'admin'">{{item.userName}}</p>
                                    <p style="display: inline;"> - {{item.creationDate}}</p>
                                    <p *ngIf="item.editDate" style="display: inline;"> - Last edit: {{item.editDate}}</p>
                                    
                                    <p *ngIf="userService.getUserName() == item.userName" class="comment-edit" (click)="OnEdit(i)">edit</p>
                                    <p *ngIf="userService.getUserName() == item.userName || userService.CheckRoleStaff()=='Administrator'" class="comment-other" (click)="OnDelete(i, item.commentId)">delete</p>
                                    <!--<p class="comment-other" (click)="OnReport()">Report</p>
                                     <p style="float: right; margin-right: 10px;"> - </p>
                                    <p class="comment-other" (click)="OnReply()">Reply</p> -->
                                    
                                </div>
                                <div>
                                    <form *ngIf="isEdit == i" id="addcomment" class="container" [formGroup]="commentService.editComment" autocomplete="off" (submit)="SaveEdit(i, item.commentId)">
                                        <div class="row" >
                                            <div class="form-group required col-md-12">
                                                <textarea id="addcommenttxt" class="form-control" formControlName="txt">{{item.txt}}</textarea>
                                                <label class="text-danger" *ngIf="commentService.editComment.get('txt').touched && commentService.editComment.get('txt').errors?.required">txt required</label>
                                            </div>
                                        </div> 
                                        <button id="addbutton" type="submit" class="btn btn-lg" [disabled]="!commentService.editComment.valid">Save</button>  
                                        <button id="addbutton" class="btn btn-lg" (click)="CancelEdit()">Cancel</button>
                                    </form>
                                    <p *ngIf="isEdit != i" class="comment-text">{{item.txt}}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
        <div class="col-md-3 d-none d-lg-block d-xl-block" style="background-color: grey;">
            3/3
        </div>
    </div>
</div>


